<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Repeated Measures ANOVA | Encyclopedia of Quantitative Methods in R, vol. 3: Testing Mean Differences</title>
  <meta name="description" content="t-tests, ANOVA, RM ANOVA, and post hoc tests." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Repeated Measures ANOVA | Encyclopedia of Quantitative Methods in R, vol. 3: Testing Mean Differences" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/EQM_v1_cover.png" />
  <meta property="og:description" content="t-tests, ANOVA, RM ANOVA, and post hoc tests." />
  <meta name="github-repo" content="cehs-research/eBook_wrangle" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Repeated Measures ANOVA | Encyclopedia of Quantitative Methods in R, vol. 3: Testing Mean Differences" />
  
  <meta name="twitter:description" content="t-tests, ANOVA, RM ANOVA, and post hoc tests." />
  <meta name="twitter:image" content="/EQM_v1_cover.png" />

<meta name="author" content="Sarah Schwartz &amp; Tyson Barrett" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="poison-example-1-2-way-anova.html"/>
<link rel="next" href="mixed-design-anova.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="heading.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Vol. 3: Testing Mean Differences</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#blocked-notes"><i class="fa fa-check"></i>Blocked Notes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#code-and-output"><i class="fa fa-check"></i>Code and Output</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-authors"><i class="fa fa-check"></i>The Authors</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-choose-r"><i class="fa fa-check"></i>Why choose R ?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#fyi"><i class="fa fa-check"></i>FYI</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ihnoprep.html"><a href="ihnoprep.html"><i class="fa fa-check"></i><b>1</b> Intro: Ihno’s Experiemnt</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ihnoprep.html"><a href="ihnoprep.html#background-of-data"><i class="fa fa-check"></i><b>1.1</b> Background of Data</a></li>
<li class="chapter" data-level="1.2" data-path="ihnoprep.html"><a href="ihnoprep.html#import-wrangle-the-data"><i class="fa fa-check"></i><b>1.2</b> Import &amp; Wrangle the Data</a></li>
<li class="chapter" data-level="1.3" data-path="ihnoprep.html"><a href="ihnoprep.html#overview"><i class="fa fa-check"></i><b>1.3</b> Overview</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="ihnoprep.html"><a href="ihnoprep.html#dimentions-size-of-the-dataset"><i class="fa fa-check"></i><b>1.3.1</b> Dimentions (size) of the dataset</a></li>
<li class="chapter" data-level="1.3.2" data-path="ihnoprep.html"><a href="ihnoprep.html#variable-names"><i class="fa fa-check"></i><b>1.3.2</b> Variable Names</a></li>
<li class="chapter" data-level="1.3.3" data-path="ihnoprep.html"><a href="ihnoprep.html#quick-glimpse"><i class="fa fa-check"></i><b>1.3.3</b> Quick Glimpse</a></li>
<li class="chapter" data-level="1.3.4" data-path="ihnoprep.html"><a href="ihnoprep.html#top-and-bottom-rows"><i class="fa fa-check"></i><b>1.3.4</b> Top and Bottom Rows</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cancerprep.html"><a href="cancerprep.html"><i class="fa fa-check"></i><b>2</b> Intro: Cancer Experiemnt</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cancerprep.html"><a href="cancerprep.html#source-of-data"><i class="fa fa-check"></i><b>2.1</b> Source of Data</a></li>
<li class="chapter" data-level="2.2" data-path="cancerprep.html"><a href="cancerprep.html#description-of-the-study"><i class="fa fa-check"></i><b>2.2</b> Description of the Study</a></li>
<li class="chapter" data-level="2.3" data-path="cancerprep.html"><a href="cancerprep.html#variables"><i class="fa fa-check"></i><b>2.3</b> Variables</a></li>
<li class="chapter" data-level="2.4" data-path="cancerprep.html"><a href="cancerprep.html#import-data"><i class="fa fa-check"></i><b>2.4</b> Import Data</a></li>
<li class="chapter" data-level="2.5" data-path="cancerprep.html"><a href="cancerprep.html#wrangle-data"><i class="fa fa-check"></i><b>2.5</b> Wrangle Data</a></li>
<li class="chapter" data-level="2.6" data-path="cancerprep.html"><a href="cancerprep.html#overview-1"><i class="fa fa-check"></i><b>2.6</b> Overview</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="cancerprep.html"><a href="cancerprep.html#dimentions-size-of-the-dataset-1"><i class="fa fa-check"></i><b>2.6.1</b> Dimentions (size) of the dataset</a></li>
<li class="chapter" data-level="2.6.2" data-path="cancerprep.html"><a href="cancerprep.html#variable-names-1"><i class="fa fa-check"></i><b>2.6.2</b> Variable Names</a></li>
<li class="chapter" data-level="2.6.3" data-path="cancerprep.html"><a href="cancerprep.html#quick-glimpse-1"><i class="fa fa-check"></i><b>2.6.3</b> Quick Glimpse</a></li>
<li class="chapter" data-level="2.6.4" data-path="cancerprep.html"><a href="cancerprep.html#top-and-bottom-rows-1"><i class="fa fa-check"></i><b>2.6.4</b> Top and Bottom Rows</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="one-sample-t-test-for-the-mean.html"><a href="one-sample-t-test-for-the-mean.html"><i class="fa fa-check"></i><b>3</b> ONE SAMPLE t-TEST: for the MEAN</a>
<ul>
<li class="chapter" data-level="3.1" data-path="one-sample-t-test-for-the-mean.html"><a href="one-sample-t-test-for-the-mean.html#exploratory-data-analysis-i.e.-the-eyeball-method"><i class="fa fa-check"></i><b>3.1</b> Exploratory Data Analysis: i.e. the eyeball method</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="one-sample-t-test-for-the-mean.html"><a href="one-sample-t-test-for-the-mean.html#mean-and-sd"><i class="fa fa-check"></i><b>3.1.1</b> Mean and SD</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="one-sample-t-test-for-the-mean.html"><a href="one-sample-t-test-for-the-mean.html#assumptions"><i class="fa fa-check"></i><b>3.2</b> Assumptions</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="one-sample-t-test-for-the-mean.html"><a href="one-sample-t-test-for-the-mean.html#random-sampling"><i class="fa fa-check"></i><b>3.2.1</b> Random Sampling</a></li>
<li class="chapter" data-level="3.2.2" data-path="one-sample-t-test-for-the-mean.html"><a href="one-sample-t-test-for-the-mean.html#normality"><i class="fa fa-check"></i><b>3.2.2</b> Normality</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="one-sample-t-test-for-the-mean.html"><a href="one-sample-t-test-for-the-mean.html#inference"><i class="fa fa-check"></i><b>3.3</b> Inference</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="one-sample-t-test-for-the-mean.html"><a href="one-sample-t-test-for-the-mean.html#all-defaults"><i class="fa fa-check"></i><b>3.3.1</b> All Defaults</a></li>
<li class="chapter" data-level="3.3.2" data-path="one-sample-t-test-for-the-mean.html"><a href="one-sample-t-test-for-the-mean.html#confidence-level-other-than-95"><i class="fa fa-check"></i><b>3.3.2</b> Confidence Level other than 95%</a></li>
<li class="chapter" data-level="3.3.3" data-path="one-sample-t-test-for-the-mean.html"><a href="one-sample-t-test-for-the-mean.html#one-sided-test-instead-of-two"><i class="fa fa-check"></i><b>3.3.3</b> One-Sided Test, instead of Two</a></li>
<li class="chapter" data-level="3.3.4" data-path="one-sample-t-test-for-the-mean.html"><a href="one-sample-t-test-for-the-mean.html#restrict-to-a-subsample"><i class="fa fa-check"></i><b>3.3.4</b> Restrict to a Subsample</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="one-sample-t-test-for-the-mean.html"><a href="one-sample-t-test-for-the-mean.html#inho-example"><i class="fa fa-check"></i><b>3.4</b> Inho example</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="t-test-for-the-difference-in-2-means-independent-samples.html"><a href="t-test-for-the-difference-in-2-means-independent-samples.html"><i class="fa fa-check"></i><b>4</b> t TEST FOR THE DIFFERENCE IN 2 MEANS, INDEPENDENT SAMPLES</a>
<ul>
<li class="chapter" data-level="4.1" data-path="t-test-for-the-difference-in-2-means-independent-samples.html"><a href="t-test-for-the-difference-in-2-means-independent-samples.html#exploratory-data-analysis-i.e.-the-eyeball-method-1"><i class="fa fa-check"></i><b>4.1</b> Exploratory Data Analysis: i.e. the eyeball method</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="t-test-for-the-difference-in-2-means-independent-samples.html"><a href="t-test-for-the-difference-in-2-means-independent-samples.html#means-and-sds"><i class="fa fa-check"></i><b>4.1.1</b> Means and SDs</a></li>
<li class="chapter" data-level="4.1.2" data-path="t-test-for-the-difference-in-2-means-independent-samples.html"><a href="t-test-for-the-difference-in-2-means-independent-samples.html#stacked-histograms"><i class="fa fa-check"></i><b>4.1.2</b> Stacked Histograms</a></li>
<li class="chapter" data-level="4.1.3" data-path="t-test-for-the-difference-in-2-means-independent-samples.html"><a href="t-test-for-the-difference-in-2-means-independent-samples.html#side-by-side-boxplots"><i class="fa fa-check"></i><b>4.1.3</b> Side-by-Side Boxplots</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="t-test-for-the-difference-in-2-means-independent-samples.html"><a href="t-test-for-the-difference-in-2-means-independent-samples.html#assumptions-1"><i class="fa fa-check"></i><b>4.2</b> Assumptions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="t-test-for-the-difference-in-2-means-independent-samples.html"><a href="t-test-for-the-difference-in-2-means-independent-samples.html#independence"><i class="fa fa-check"></i><b>4.2.1</b> 1. Independence</a></li>
<li class="chapter" data-level="4.2.2" data-path="t-test-for-the-difference-in-2-means-independent-samples.html"><a href="t-test-for-the-difference-in-2-means-independent-samples.html#normality-1"><i class="fa fa-check"></i><b>4.2.2</b> 2. Normality</a></li>
<li class="chapter" data-level="4.2.3" data-path="t-test-for-the-difference-in-2-means-independent-samples.html"><a href="t-test-for-the-difference-in-2-means-independent-samples.html#hov"><i class="fa fa-check"></i><b>4.2.3</b> 2. HOV</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="t-test-for-the-difference-in-2-means-independent-samples.html"><a href="t-test-for-the-difference-in-2-means-independent-samples.html#inference-1"><i class="fa fa-check"></i><b>4.3</b> Inference</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="t-test-for-the-difference-in-2-means-independent-samples.html"><a href="t-test-for-the-difference-in-2-means-independent-samples.html#pooled-variance-test"><i class="fa fa-check"></i><b>4.3.1</b> Pooled Variance Test</a></li>
<li class="chapter" data-level="4.3.2" data-path="t-test-for-the-difference-in-2-means-independent-samples.html"><a href="t-test-for-the-difference-in-2-means-independent-samples.html#seperate-variance-test"><i class="fa fa-check"></i><b>4.3.2</b> Seperate Variance Test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html"><i class="fa fa-check"></i><b>5</b> One-Way ANOVA: Code</a>
<ul>
<li class="chapter" data-level="5.1" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#prepare-work"><i class="fa fa-check"></i><b>5.1</b> Prepare Work</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#ensure-the-data-is-in-long-format"><i class="fa fa-check"></i><b>5.1.1</b> Ensure the Data is in “long” Format</a></li>
<li class="chapter" data-level="5.1.2" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#check-the-variables"><i class="fa fa-check"></i><b>5.1.2</b> Check the Variables</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>5.2</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#compute-summary-statistics"><i class="fa fa-check"></i><b>5.2.1</b> Compute Summary Statistics</a></li>
<li class="chapter" data-level="5.2.2" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#plot-the-observed-data"><i class="fa fa-check"></i><b>5.2.2</b> Plot the Observed Data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#assumption-checks"><i class="fa fa-check"></i><b>5.3</b> Assumption Checks</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#independent-random-samples"><i class="fa fa-check"></i><b>5.3.1</b> Independent, Random Samples</a></li>
<li class="chapter" data-level="5.3.2" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#normality-2"><i class="fa fa-check"></i><b>5.3.2</b> Normality</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#one-way-anova-model"><i class="fa fa-check"></i><b>5.4</b> One-way ANOVA Model</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#fit-save-the-model"><i class="fa fa-check"></i><b>5.4.1</b> Fit &amp; Save the Model</a></li>
<li class="chapter" data-level="5.4.2" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#basic-output---stored-name-of-model"><i class="fa fa-check"></i><b>5.4.2</b> Basic Output - stored name of model</a></li>
<li class="chapter" data-level="5.4.3" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#fuller-output---add-anova-on-model-name"><i class="fa fa-check"></i><b>5.4.3</b> Fuller Output - add $Anova on model name</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#followup-tests"><i class="fa fa-check"></i><b>5.5</b> Followup-tests</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#estimated-marginal-means-with-emmeansemmeans-group_var"><i class="fa fa-check"></i><b>5.5.1</b> Estimated Marginal Means with <code>emmeans::emmeans(~ group_var)</code></a></li>
<li class="chapter" data-level="5.5.2" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#all-pairwise-comparisons-with-pairs"><i class="fa fa-check"></i><b>5.5.2</b> All Pairwise Comparisons with <code>pairs()</code></a></li>
<li class="chapter" data-level="5.5.3" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#plot-marginal-means-with-emmeansemmip-group_var"><i class="fa fa-check"></i><b>5.5.3</b> Plot Marginal Means with <code>emmeans::emmip(~ group_var)</code></a></li>
<li class="chapter" data-level="5.5.4" data-path="one-way-anova-code.html"><a href="one-way-anova-code.html#contrast-statements-with-emmeanscontrast"><i class="fa fa-check"></i><b>5.5.4</b> Contrast Statements with <code>emmeans::contrast()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html"><i class="fa fa-check"></i><b>6</b> Poison Example: 1 &amp; 2-way ANOVA</a>
<ul>
<li class="chapter" data-level="6.1" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#prepare-for-modeling"><i class="fa fa-check"></i><b>6.1</b> Prepare for Modeling</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#ensure-the-data-is-in-long-format-1"><i class="fa fa-check"></i><b>6.1.1</b> Ensure the Data is in “long” Format</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#example-1-survival-time-by-poison-type"><i class="fa fa-check"></i><b>6.2</b> Example 1) Survival Time by Poison Type</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#research-question"><i class="fa fa-check"></i><b>6.2.1</b> Research Question</a></li>
<li class="chapter" data-level="6.2.2" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#exploratory-data-analysis-1"><i class="fa fa-check"></i><b>6.2.2</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="6.2.3" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#assumption-checks-1"><i class="fa fa-check"></i><b>6.2.3</b> Assumption Checks</a></li>
<li class="chapter" data-level="6.2.4" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#fitting-one-way-anova-model"><i class="fa fa-check"></i><b>6.2.4</b> Fitting One-way ANOVA Model</a></li>
<li class="chapter" data-level="6.2.5" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#followup-tests-1"><i class="fa fa-check"></i><b>6.2.5</b> Followup-tests</a></li>
<li class="chapter" data-level="6.2.6" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#apa-write-up"><i class="fa fa-check"></i><b>6.2.6</b> APA Write Up</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#example-2-survival-time-by-treatment-type"><i class="fa fa-check"></i><b>6.3</b> Example 2) Survival Time by Treatment Type</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#parepare-for-analysis"><i class="fa fa-check"></i><b>6.3.1</b> Parepare for Analysis</a></li>
<li class="chapter" data-level="6.3.2" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#fitting-one-way-anova-model-1"><i class="fa fa-check"></i><b>6.3.2</b> Fitting One-way ANOVA Model</a></li>
<li class="chapter" data-level="6.3.3" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#followup-tests-2"><i class="fa fa-check"></i><b>6.3.3</b> Followup-tests</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#example-3-survival-time-by-both-poisson-treatment-type"><i class="fa fa-check"></i><b>6.4</b> Example 3) Survival Time by Both Poisson &amp; Treatment Type</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#parepare-for-analysis-1"><i class="fa fa-check"></i><b>6.4.1</b> Parepare for Analysis</a></li>
<li class="chapter" data-level="6.4.2" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#fitting-two-way-anova-model"><i class="fa fa-check"></i><b>6.4.2</b> Fitting Two-way ANOVA Model</a></li>
<li class="chapter" data-level="6.4.3" data-path="poison-example-1-2-way-anova.html"><a href="poison-example-1-2-way-anova.html#followup-tests-3"><i class="fa fa-check"></i><b>6.4.3</b> Followup-tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html"><i class="fa fa-check"></i><b>7</b> Repeated Measures ANOVA</a>
<ul>
<li class="chapter" data-level="7.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#tutorial---fitting-rm-anova-models-with-afexaov_4"><i class="fa fa-check"></i><b>7.1</b> Tutorial - Fitting RM ANOVA Models with afex::aov_4()</a></li>
<li class="chapter" data-level="7.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#words-recalled-data-example-chapter-15-section-a"><i class="fa fa-check"></i><b>7.2</b> Words Recalled Data Example (Chapter 15, section A)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#data-prep"><i class="fa fa-check"></i><b>7.2.1</b> Data Prep</a></li>
<li class="chapter" data-level="7.2.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#one-way-independent-anova"><i class="fa fa-check"></i><b>7.2.2</b> One-Way Independent ANOVA</a></li>
<li class="chapter" data-level="7.2.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#one-way-rm-anova"><i class="fa fa-check"></i><b>7.2.3</b> One-Way RM ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#another-example---weight-loss"><i class="fa fa-check"></i><b>7.3</b> Another Example - Weight Loss</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#restructure-the-data-from-wide-to-long-format"><i class="fa fa-check"></i><b>7.3.1</b> Restructure the data from wide to long format</a></li>
<li class="chapter" data-level="7.3.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#does-weight-long-change-over-time"><i class="fa fa-check"></i><b>7.3.2</b> Does weight long change over time?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mixed-design-anova.html"><a href="mixed-design-anova.html"><i class="fa fa-check"></i><b>8</b> Mixed Design ANOVA</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mixed-design-anova.html"><a href="mixed-design-anova.html#tutorial---fitting-mixed-design-anova-models-with-afexaov_4"><i class="fa fa-check"></i><b>8.1</b> Tutorial - Fitting Mixed Design ANOVA Models with <code>afex::aov_4()</code></a></li>
<li class="chapter" data-level="8.2" data-path="mixed-design-anova.html"><a href="mixed-design-anova.html#words-recalled-data-example-chapter-16-section-a"><i class="fa fa-check"></i><b>8.2</b> Words Recalled Data Example (Chapter 16, section A)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mixed-design-anova.html"><a href="mixed-design-anova.html#data-prep-1"><i class="fa fa-check"></i><b>8.2.1</b> Data Prep</a></li>
<li class="chapter" data-level="8.2.2" data-path="mixed-design-anova.html"><a href="mixed-design-anova.html#one-way-rm-anova-1"><i class="fa fa-check"></i><b>8.2.2</b> One-Way RM ANOVA</a></li>
<li class="chapter" data-level="8.2.3" data-path="mixed-design-anova.html"><a href="mixed-design-anova.html#mixed-anova"><i class="fa fa-check"></i><b>8.2.3</b> Mixed ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mixed-design-anova.html"><a href="mixed-design-anova.html#conclusion"><i class="fa fa-check"></i><b>8.3</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Encyclopedia of Quantitative Methods in R, vol. 3: Testing Mean Differences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="repeated-measures-anova" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> Repeated Measures ANOVA<a href="repeated-measures-anova.html#repeated-measures-anova" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Required Packages</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="repeated-measures-anova.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)    <span class="co"># Loads several very helpful &#39;tidy&#39; packages</span></span>
<span id="cb165-2"><a href="repeated-measures-anova.html#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(furniture)    <span class="co"># Nice tables (by our own Tyson Barrett)</span></span>
<span id="cb165-3"><a href="repeated-measures-anova.html#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(afex)         <span class="co"># needed for ANOVA, emmeans is loaded automatically.</span></span>
<span id="cb165-4"><a href="repeated-measures-anova.html#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)     <span class="co"># for advanced control for multiple testing/Type 1 error</span></span></code></pre></div>
<div id="tutorial---fitting-rm-anova-models-with-afexaov_4" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Tutorial - Fitting RM ANOVA Models with afex::aov_4()<a href="repeated-measures-anova.html#tutorial---fitting-rm-anova-models-with-afexaov_4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>aov_4()</code> function from the <code>afex</code> package fits ANOVA models (oneway, two-way, repeated measures, and mixed design). It needs at least two arguments:</p>
<ol style="list-style-type: decimal">
<li><p>formula: <code>continuous_var ~ 1 + (RM_var|id_var)</code> <em>one observation per subject for each level of the <code>RMvar</code>, so each <code>id_var</code> has multiple lines for each subject</em></p></li>
<li><p>dataset: <code>data = .</code> <em>we use the period to signify that the datset is being piped from above</em></p></li>
</ol>
<p>Here is an outline of what your syntax should look like when you <strong>fit and save a RM ANOVA</strong>. Of course you will replace the dataset name and the variable names, as well as the name you are saving it as.</p>
<div class="rmdlightbulb">
<p>
<strong>NOTE:</strong> The <code>aov_4()</code> function works on
data in LONG format only. Each observation needs to be on its one line
or row with seperate variables for the group membership (categorical
factor or <code>fct</code>) and the continuous measurement (numberic or
<code>dbl</code>).
</p>
</div>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="repeated-measures-anova.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RM ANOVA: fit and save</span></span>
<span id="cb166-2"><a href="repeated-measures-anova.html#cb166-2" aria-hidden="true" tabindex="-1"></a>aov_name <span class="ot">&lt;-</span> data_name <span class="sc">%&gt;%</span> </span>
<span id="cb166-3"><a href="repeated-measures-anova.html#cb166-3" aria-hidden="true" tabindex="-1"></a>  afex<span class="sc">::</span><span class="fu">aov_4</span>(continuous_var <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (RM_var<span class="sc">|</span>id_var),</span>
<span id="cb166-4"><a href="repeated-measures-anova.html#cb166-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> .)</span></code></pre></div>
<p>By running the name you saved you model under, you will get a brief set of output, including a measure of <strong>Effect Size</strong>.</p>
<div class="rmdlightbulb">
<p>
<strong>NOTE:</strong> The <code>ges</code> is the <em>generalized
eta squared</em>. In a one-way ANOVA, the eta-squared effect size is the
same value, ie. generalized <span class="math inline"><span class="math inline">\(\eta_g\)</span></span>
and partial <span class="math inline"><span class="math inline">\(\eta_p\)</span></span> are the
same.
</p>
</div>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="repeated-measures-anova.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display basic ANOVA results (includes effect size)</span></span>
<span id="cb167-2"><a href="repeated-measures-anova.html#cb167-2" aria-hidden="true" tabindex="-1"></a>aov_name </span></code></pre></div>
<p>To fully fill out a standard ANOVA table and compute other effect sizes, you will need a more complete set of output, including the <strong>Sum of Squares</strong> components, you will need to add <code>summary()</code> piped at the end of the model name before running it or after the model with a pipe.</p>
<div class="rmdlightbulb">
<p>
<strong>NOTE:</strong> IGNORE the first line that starts with
<code>(Intercept)</code>! Also, the ‘mean sum of squares’ are not
included in this table, nor is the <strong>Total</strong> line at the
bottom of the standard ANOVA table. You will need to manually compute
these values and add them on the homework page. Remember that
<code>Sum of Squares (SS)</code> and
<code>degrees of freedom (df)</code> add up, but
<code>Mean Sum of Squreas (MS)</code> do not add up. Also:
<code>MS = SS/df</code> for each term.
</p>
</div>
<p>This also runs and displays the results of Mauchly Tests for Sphericity, as well as the Greenhouse-Geisser (GG) and Huynh-Feldt (HF) Corrections to the p-value. If the Mauchly’s p-value is bigger than .05, do not use the corrections. If Mauchly’s p-value is less than .05, then apply the epsilon (<code>eps</code> or <span class="math inline">\(\epsilon\)</span>) to multiply the degree’s of freedom. Yes, the df will be decimal numbers.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="repeated-measures-anova.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display fuller ANOVA results (sphericity tests)</span></span>
<span id="cb168-2"><a href="repeated-measures-anova.html#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_name)</span></code></pre></div>
<p>To see all the Sumes-of-Squared residuals for ALL of the model comoponents, you add <code>$aov</code> at the end of the model name.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="repeated-measures-anova.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display all the sum of squares</span></span>
<span id="cb169-2"><a href="repeated-measures-anova.html#cb169-2" aria-hidden="true" tabindex="-1"></a>aov_name<span class="sc">$</span>aov</span></code></pre></div>
<p>Repeated Measures MANOVA Tests (Pillai test statistic) is computed is you add <code>$Anova</code> at the end of the model name. This is a so called ‘Multivariate Test’. <strong>This is NOT what you want to do!</strong></p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="repeated-measures-anova.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display fuller ANOVA results (includes sum of squares)</span></span>
<span id="cb170-2"><a href="repeated-measures-anova.html#cb170-2" aria-hidden="true" tabindex="-1"></a>aov_name<span class="sc">$</span>Anova</span></code></pre></div>
<p>If you only need to obtain the omnibus (overall) F-test without a correction for violation of sphericity, you can add an option for <code>correction = "none"</code>. You can also request both the generalized and partial <span class="math inline">\(\eta^2\)</span> effect sizes with <code>es = c("ges", "pes")</code>.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="repeated-measures-anova.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RM ANOVA: no correction, both effect sizes</span></span>
<span id="cb171-2"><a href="repeated-measures-anova.html#cb171-2" aria-hidden="true" tabindex="-1"></a>data_name <span class="sc">%&gt;%</span> </span>
<span id="cb171-3"><a href="repeated-measures-anova.html#cb171-3" aria-hidden="true" tabindex="-1"></a>  afex<span class="sc">::</span><span class="fu">aov_4</span>(continuous_var <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (RM_var<span class="sc">|</span>id_var),</span>
<span id="cb171-4"><a href="repeated-measures-anova.html#cb171-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> .,</span>
<span id="cb171-5"><a href="repeated-measures-anova.html#cb171-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">correction =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb171-6"><a href="repeated-measures-anova.html#cb171-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">es =</span> <span class="fu">c</span>(<span class="st">&quot;ges&quot;</span>, <span class="st">&quot;pes&quot;</span>)))</span></code></pre></div>
<p>Post Hoc tests may be ran the same way as the 1 and 2-way ANOVAs from the last unit.</p>
<div class="rmdlightbulb">
<p>
<strong>NOTE:</strong> Use Fisher’s LSD
(<code>adjust = “none”</code>) if the omnibus F-test is significant AND
there are THREE measurements per subject or block. Tukey’s HSD
(<code>adjust = “tukey”</code>) may be used even if the F-test is not
significant or if there are four or more repeated measures.
</p>
</div>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="repeated-measures-anova.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RM ANOVA: post hoc all pairwise tests with Fisher&#39;s LSD correction</span></span>
<span id="cb172-2"><a href="repeated-measures-anova.html#cb172-2" aria-hidden="true" tabindex="-1"></a>aov_name <span class="sc">%&gt;%</span> </span>
<span id="cb172-3"><a href="repeated-measures-anova.html#cb172-3" aria-hidden="true" tabindex="-1"></a>  emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="sc">~</span> RM_var) <span class="sc">%&gt;%</span> </span>
<span id="cb172-4"><a href="repeated-measures-anova.html#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>(<span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="repeated-measures-anova.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RM ANOVA: post hoc all pairwise tests with Tukey&#39;s HSD correction</span></span>
<span id="cb173-2"><a href="repeated-measures-anova.html#cb173-2" aria-hidden="true" tabindex="-1"></a>aov_name <span class="sc">%&gt;%</span> </span>
<span id="cb173-3"><a href="repeated-measures-anova.html#cb173-3" aria-hidden="true" tabindex="-1"></a>  emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="sc">~</span> RM_var) <span class="sc">%&gt;%</span> </span>
<span id="cb173-4"><a href="repeated-measures-anova.html#cb173-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>(<span class="at">adjust =</span> <span class="st">&quot;tukey&quot;</span>)</span></code></pre></div>
<p>A means plot (model based) can help you write up your results. This zooms in on just the means and will make all differences seem significant, so make sure to interpret it in conjunction with the ANOVA and post hoc tests.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="repeated-measures-anova.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RM ANOVA: means plot</span></span>
<span id="cb174-2"><a href="repeated-measures-anova.html#cb174-2" aria-hidden="true" tabindex="-1"></a>aov_name <span class="sc">%&gt;%</span> </span>
<span id="cb174-3"><a href="repeated-measures-anova.html#cb174-3" aria-hidden="true" tabindex="-1"></a>  emmeans<span class="sc">::</span><span class="fu">emmip</span>(<span class="sc">~</span> RM_var)</span></code></pre></div>
</div>
<div id="words-recalled-data-example-chapter-15-section-a" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Words Recalled Data Example (Chapter 15, section A)<a href="repeated-measures-anova.html#words-recalled-data-example-chapter-15-section-a" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="data-prep" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Data Prep<a href="repeated-measures-anova.html#data-prep" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I input the data as a <code>tribble</code> which saves it as a <code>data.frame</code> and then cleaned up a few of the important variables.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="repeated-measures-anova.html#cb175-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb175-2"><a href="repeated-measures-anova.html#cb175-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>ID, <span class="sc">~</span>word_type, <span class="sc">~</span>words_recalled,</span>
<span id="cb175-3"><a href="repeated-measures-anova.html#cb175-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>,          <span class="dv">1</span>,              <span class="dv">20</span>,</span>
<span id="cb175-4"><a href="repeated-measures-anova.html#cb175-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>,          <span class="dv">1</span>,              <span class="dv">16</span>,</span>
<span id="cb175-5"><a href="repeated-measures-anova.html#cb175-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>,          <span class="dv">1</span>,               <span class="dv">8</span>,</span>
<span id="cb175-6"><a href="repeated-measures-anova.html#cb175-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>,          <span class="dv">1</span>,              <span class="dv">17</span>,</span>
<span id="cb175-7"><a href="repeated-measures-anova.html#cb175-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>,          <span class="dv">1</span>,              <span class="dv">15</span>,</span>
<span id="cb175-8"><a href="repeated-measures-anova.html#cb175-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>,          <span class="dv">1</span>,              <span class="dv">10</span>,</span>
<span id="cb175-9"><a href="repeated-measures-anova.html#cb175-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>,          <span class="dv">2</span>,              <span class="dv">21</span>,</span>
<span id="cb175-10"><a href="repeated-measures-anova.html#cb175-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>,          <span class="dv">2</span>,              <span class="dv">18</span>,</span>
<span id="cb175-11"><a href="repeated-measures-anova.html#cb175-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>,          <span class="dv">2</span>,               <span class="dv">7</span>,</span>
<span id="cb175-12"><a href="repeated-measures-anova.html#cb175-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>,          <span class="dv">2</span>,              <span class="dv">15</span>,</span>
<span id="cb175-13"><a href="repeated-measures-anova.html#cb175-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>,          <span class="dv">2</span>,              <span class="dv">10</span>,</span>
<span id="cb175-14"><a href="repeated-measures-anova.html#cb175-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>,          <span class="dv">2</span>,               <span class="dv">4</span>,</span>
<span id="cb175-15"><a href="repeated-measures-anova.html#cb175-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>,          <span class="dv">3</span>,              <span class="dv">17</span>,</span>
<span id="cb175-16"><a href="repeated-measures-anova.html#cb175-16" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>,          <span class="dv">3</span>,              <span class="dv">11</span>,</span>
<span id="cb175-17"><a href="repeated-measures-anova.html#cb175-17" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>,          <span class="dv">3</span>,               <span class="dv">4</span>,</span>
<span id="cb175-18"><a href="repeated-measures-anova.html#cb175-18" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>,          <span class="dv">3</span>,              <span class="dv">18</span>,</span>
<span id="cb175-19"><a href="repeated-measures-anova.html#cb175-19" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>,          <span class="dv">3</span>,              <span class="dv">13</span>,</span>
<span id="cb175-20"><a href="repeated-measures-anova.html#cb175-20" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>,          <span class="dv">3</span>,              <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb175-21"><a href="repeated-measures-anova.html#cb175-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">word_type =</span> <span class="fu">factor</span>(word_type,</span>
<span id="cb175-22"><a href="repeated-measures-anova.html#cb175-22" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Neutral&quot;</span>, <span class="st">&quot;Positive&quot;</span>, <span class="st">&quot;Negative&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb175-23"><a href="repeated-measures-anova.html#cb175-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fake_id =</span> <span class="fu">row_number</span>())</span>
<span id="cb175-24"><a href="repeated-measures-anova.html#cb175-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-25"><a href="repeated-measures-anova.html#cb175-25" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code># A tibble: 18 × 4
      ID word_type words_recalled fake_id
   &lt;dbl&gt; &lt;fct&gt;              &lt;dbl&gt;   &lt;int&gt;
 1     1 Neutral               20       1
 2     2 Neutral               16       2
 3     3 Neutral                8       3
 4     4 Neutral               17       4
 5     5 Neutral               15       5
 6     6 Neutral               10       6
 7     1 Positive              21       7
 8     2 Positive              18       8
 9     3 Positive               7       9
10     4 Positive              15      10
11     5 Positive              10      11
12     6 Positive               4      12
13     1 Negative              17      13
14     2 Negative              11      14
15     3 Negative               4      15
16     4 Negative              18      16
17     5 Negative              13      17
18     6 Negative              10      18</code></pre>
</div>
<div id="one-way-independent-anova" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> One-Way Independent ANOVA<a href="repeated-measures-anova.html#one-way-independent-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, let’s ignore the fact that we know this has repeated measures. As such, we will assume that each word type group is independent. Let’s look at what happens:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="repeated-measures-anova.html#cb177-1" aria-hidden="true" tabindex="-1"></a>ind_anova <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb177-2"><a href="repeated-measures-anova.html#cb177-2" aria-hidden="true" tabindex="-1"></a>  afex<span class="sc">::</span><span class="fu">aov_4</span>(words_recalled <span class="sc">~</span> word_type <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>fake_id),</span>
<span id="cb177-3"><a href="repeated-measures-anova.html#cb177-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> .)</span>
<span id="cb177-4"><a href="repeated-measures-anova.html#cb177-4" aria-hidden="true" tabindex="-1"></a>ind_anova<span class="sc">$</span>Anova</span></code></pre></div>
<pre><code>Anova Table (Type III tests)

Response: dv
             Sum Sq Df  F value    Pr(&gt;F)    
(Intercept) 3042.00  1 101.4752 4.538e-08 ***
word_type     16.33  2   0.2724    0.7652    
Residuals    449.67 15                       
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>If we ignored that the <code>word_type</code> groups are not independent, we get an F-statistic = 0.272 and p = 0.765.</p>
<p>What do you think will happen if we account for the repeated measures? Will the F-statistic increase or decrease?</p>
</div>
<div id="one-way-rm-anova" class="section level3 hasAnchor" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> One-Way RM ANOVA<a href="repeated-measures-anova.html#one-way-rm-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now, let’s look at the repeated measures. We do this by using <code>afex::aov_4()</code> and then the <code>summary()</code> functions as shown below.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="repeated-measures-anova.html#cb179-1" aria-hidden="true" tabindex="-1"></a>oneway <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb179-2"><a href="repeated-measures-anova.html#cb179-2" aria-hidden="true" tabindex="-1"></a>  afex<span class="sc">::</span><span class="fu">aov_4</span>(words_recalled <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (word_type<span class="sc">|</span>ID),</span>
<span id="cb179-3"><a href="repeated-measures-anova.html#cb179-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> .)</span>
<span id="cb179-4"><a href="repeated-measures-anova.html#cb179-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(oneway)</span></code></pre></div>
<pre><code>
Univariate Type III Repeated-Measures ANOVA Assuming Sphericity

             Sum Sq num Df Error SS den Df F value   Pr(&gt;F)   
(Intercept) 3042.00      1   381.33      5 39.8864 0.001466 **
word_type     16.33      2    68.33     10  1.1951 0.342453   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1


Mauchly Tests for Sphericity

          Test statistic  p-value
word_type         0.2134 0.045538


Greenhouse-Geisser and Huynh-Feldt Corrections
 for Departure from Sphericity

           GG eps Pr(&gt;F[GG])
word_type 0.55972     0.3282

             HF eps Pr(&gt;F[HF])
word_type 0.6077293  0.3309148</code></pre>
<p>Here, we see a number of pieces of information, including the sums of squares, F-statistic, and p-value. The F-statistic is now 1.195 and the p-value (although still not signfiicant) is .342. So what happened to the F-statistic? It decreased! So by using the information that these are repeated measures, we have more power. Why is that?</p>
<p>If we look at the output for the two ANOVAs above, both have the sums of squares for <code>word_type</code> at 16.33 so that didn’t change at all. So what did change? Well, it comes down to understanding what is happening to the error term. Although not shown explicitly in the tables above, consider that:</p>
<p><span class="math display">\[
\text{Independent ANOVA: } SS_{total} = SS_{bet} + SS_w
\]</span></p>
<p><span class="math display">\[
\text{RM ANOVA: } SS_{total} = SS_{RM} + SS_{sub} + SS_{inter}
\]</span></p>
<p><span class="math inline">\(SS_{total}\)</span> is the same in both and <span class="math inline">\(SS_{RM} = SS_{RM}\)</span> so what we are doing is splitting up the <span class="math inline">\(SS_w\)</span> into <span class="math inline">\(SS_{sub} + SS_{inter}\)</span> where only the <span class="math inline">\(SS_{inter}\)</span> is the error term now.</p>
<p>This means we have more power with the same amount of data.</p>
<p>Let’s now plot this using a spaghetti plot.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="repeated-measures-anova.html#cb181-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span></span>
<span id="cb181-2"><a href="repeated-measures-anova.html#cb181-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(word_type, words_recalled, <span class="at">group =</span> ID)) <span class="sc">+</span></span>
<span id="cb181-3"><a href="repeated-measures-anova.html#cb181-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb181-4"><a href="repeated-measures-anova.html#cb181-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-130-1.png" width="75%" /></p>
<p>The output provides us with a bit of an understanding of why there is not a significant effect of <code>word_type</code>. In addition to a spaghetti plot, it is often useful to show what the overall repeated measure factor is doing, not the individuals (especially if your sample size is larger than 20). To do that, we can use:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="repeated-measures-anova.html#cb182-1" aria-hidden="true" tabindex="-1"></a>oneway <span class="sc">%&gt;%</span></span>
<span id="cb182-2"><a href="repeated-measures-anova.html#cb182-2" aria-hidden="true" tabindex="-1"></a>  emmeans<span class="sc">::</span><span class="fu">emmip</span>(<span class="sc">~</span> word_type)</span></code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-131-1.png" width="75%" /></p>
<p>Although there is a pattern here, we need to consider the scale. Looking at the spaghetti plot, we have individuals that range from 5 to 20 so a difference of 2 or 3 is not large. However, it is clear that a pattern may exist and so we should probably investigate this further, possibly with a larger sample size.</p>
</div>
</div>
<div id="another-example---weight-loss" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Another Example - Weight Loss<a href="repeated-measures-anova.html#another-example---weight-loss" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Contrived data on weight loss and self esteem over three months, for three groups of individuals: Control, Diet and Diet + Exercise. The data constitute a double-multivariate design.</p>
<div id="restructure-the-data-from-wide-to-long-format" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Restructure the data from wide to long format<a href="repeated-measures-anova.html#restructure-the-data-from-wide-to-long-format" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Wide format</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="repeated-measures-anova.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(carData<span class="sc">::</span>WeightLoss, <span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>    group wl1 wl2 wl3 se1 se2 se3
1 Control   4   3   3  14  13  15
2 Control   4   4   3  13  14  17
3 Control   4   3   1  17  12  16
4 Control   3   2   1  11  11  12
5 Control   5   3   2  16  15  14
6 Control   6   5   4  17  18  18</code></pre>
<p>Restructure</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="repeated-measures-anova.html#cb185-1" aria-hidden="true" tabindex="-1"></a>WeightLoss_long <span class="ot">&lt;-</span> carData<span class="sc">::</span>WeightLoss <span class="sc">%&gt;%</span> </span>
<span id="cb185-2"><a href="repeated-measures-anova.html#cb185-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>() <span class="sc">%&gt;%</span> <span class="fu">factor</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb185-3"><a href="repeated-measures-anova.html#cb185-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">gather</span>(<span class="at">key =</span> var,</span>
<span id="cb185-4"><a href="repeated-measures-anova.html#cb185-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">value =</span> value,</span>
<span id="cb185-5"><a href="repeated-measures-anova.html#cb185-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">starts_with</span>(<span class="st">&quot;wl&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;se&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb185-6"><a href="repeated-measures-anova.html#cb185-6" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(var,</span>
<span id="cb185-7"><a href="repeated-measures-anova.html#cb185-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sep =</span> <span class="dv">2</span>,</span>
<span id="cb185-8"><a href="repeated-measures-anova.html#cb185-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;measure&quot;</span>, <span class="st">&quot;month&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb185-9"><a href="repeated-measures-anova.html#cb185-9" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">spread</span>(<span class="at">key =</span> measure,</span>
<span id="cb185-10"><a href="repeated-measures-anova.html#cb185-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">value =</span> value) <span class="sc">%&gt;%</span> </span>
<span id="cb185-11"><a href="repeated-measures-anova.html#cb185-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id, group, month, wl, se) <span class="sc">%&gt;%</span> </span>
<span id="cb185-12"><a href="repeated-measures-anova.html#cb185-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">vars</span>(id, month), factor) <span class="sc">%&gt;%</span> </span>
<span id="cb185-13"><a href="repeated-measures-anova.html#cb185-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(id, month) </span></code></pre></div>
<p>Long format</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="repeated-measures-anova.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(WeightLoss_long, <span class="at">n =</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>   id   group month wl se
1   1 Control     1  4 14
2   1 Control     2  3 13
3   1 Control     3  3 15
4   2 Control     1  4 13
5   2 Control     2  4 14
6   2 Control     3  3 17
7   3 Control     1  4 17
8   3 Control     2  3 12
9   3 Control     3  1 16
10  4 Control     1  3 11
11  4 Control     2  2 11
12  4 Control     3  1 12
13  5 Control     1  5 16
14  5 Control     2  3 15
15  5 Control     3  2 14
16  6 Control     1  6 17
17  6 Control     2  5 18
18  6 Control     3  4 18
19  7 Control     1  6 17
20  7 Control     2  5 16</code></pre>
<p>Summary table</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="repeated-measures-anova.html#cb188-1" aria-hidden="true" tabindex="-1"></a>WeightLoss_long <span class="sc">%&gt;%</span> </span>
<span id="cb188-2"><a href="repeated-measures-anova.html#cb188-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(group, month) <span class="sc">%&gt;%</span> </span>
<span id="cb188-3"><a href="repeated-measures-anova.html#cb188-3" aria-hidden="true" tabindex="-1"></a>  furniture<span class="sc">::</span><span class="fu">table1</span>(wl, se)</span></code></pre></div>
<pre><code>
───────────────────────────────────────────────────────────────────────────────────────────────────────
                                             group, month 
    Control-1  Diet-1     DietEx-1   Control-2  Diet-2     DietEx-2  
    n = 12     n = 12     n = 10     n = 12     n = 12     n = 10    
 wl                                                                  
    4.5 (1.0)  5.3 (1.4)  6.2 (2.3)  3.3 (1.1)  3.9 (1.4)  6.1 (1.4) 
 se                                                                  
    14.8 (1.9) 14.8 (2.4) 15.2 (1.3) 14.3 (1.9) 13.8 (2.8) 13.3 (1.9)
 Control-3  Diet-3     DietEx-3  
 n = 12     n = 12     n = 10    
                                 
 2.1 (1.2)  2.2 (1.1)  2.2 (1.2) 
                                 
 15.1 (2.4) 16.2 (2.5) 17.6 (1.0)
───────────────────────────────────────────────────────────────────────────────────────────────────────</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="repeated-measures-anova.html#cb190-1" aria-hidden="true" tabindex="-1"></a>carData<span class="sc">::</span>WeightLoss <span class="sc">%&gt;%</span> </span>
<span id="cb190-2"><a href="repeated-measures-anova.html#cb190-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> </span>
<span id="cb190-3"><a href="repeated-measures-anova.html#cb190-3" aria-hidden="true" tabindex="-1"></a>  furniture<span class="sc">::</span><span class="fu">table1</span>(wl1, wl2, wl3,</span>
<span id="cb190-4"><a href="repeated-measures-anova.html#cb190-4" aria-hidden="true" tabindex="-1"></a>                    se1, se2, se3)</span></code></pre></div>
<pre><code>
──────────────────────────────────────
                group 
     Control    Diet       DietEx    
     n = 12     n = 12     n = 10    
 wl1                                 
     4.5 (1.0)  5.3 (1.4)  6.2 (2.3) 
 wl2                                 
     3.3 (1.1)  3.9 (1.4)  6.1 (1.4) 
 wl3                                 
     2.1 (1.2)  2.2 (1.1)  2.2 (1.2) 
 se1                                 
     14.8 (1.9) 14.8 (2.4) 15.2 (1.3)
 se2                                 
     14.3 (1.9) 13.8 (2.8) 13.3 (1.9)
 se3                                 
     15.1 (2.4) 16.2 (2.5) 17.6 (1.0)
──────────────────────────────────────</code></pre>
<p>Raw data plot (exploratory)</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="repeated-measures-anova.html#cb192-1" aria-hidden="true" tabindex="-1"></a>WeightLoss_long <span class="sc">%&gt;%</span> </span>
<span id="cb192-2"><a href="repeated-measures-anova.html#cb192-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">gather</span>(<span class="at">key =</span> measure,</span>
<span id="cb192-3"><a href="repeated-measures-anova.html#cb192-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">value =</span> value,</span>
<span id="cb192-4"><a href="repeated-measures-anova.html#cb192-4" aria-hidden="true" tabindex="-1"></a>                wl, se) <span class="sc">%&gt;%</span> </span>
<span id="cb192-5"><a href="repeated-measures-anova.html#cb192-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">measure =</span> <span class="fu">fct_recode</span>(measure,</span>
<span id="cb192-6"><a href="repeated-measures-anova.html#cb192-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&quot;Weight Loss, lb&quot;</span> <span class="ot">=</span> <span class="st">&quot;wl&quot;</span>,</span>
<span id="cb192-7"><a href="repeated-measures-anova.html#cb192-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&quot;Self Esteem Rating&quot;</span> <span class="ot">=</span> <span class="st">&quot;se&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb192-8"><a href="repeated-measures-anova.html#cb192-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> month,</span>
<span id="cb192-9"><a href="repeated-measures-anova.html#cb192-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> value <span class="sc">%&gt;%</span> as.numeric <span class="sc">%&gt;%</span> jitter,</span>
<span id="cb192-10"><a href="repeated-measures-anova.html#cb192-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> id)) <span class="sc">+</span></span>
<span id="cb192-11"><a href="repeated-measures-anova.html#cb192-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(measure <span class="sc">~</span> group, </span>
<span id="cb192-12"><a href="repeated-measures-anova.html#cb192-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">scale =</span> <span class="st">&quot;free_y&quot;</span>,</span>
<span id="cb192-13"><a href="repeated-measures-anova.html#cb192-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb192-14"><a href="repeated-measures-anova.html#cb192-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb192-15"><a href="repeated-measures-anova.html#cb192-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb192-16"><a href="repeated-measures-anova.html#cb192-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Time, months&quot;</span>,</span>
<span id="cb192-17"><a href="repeated-measures-anova.html#cb192-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Measurement Value&quot;</span>,</span>
<span id="cb192-18"><a href="repeated-measures-anova.html#cb192-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Person Profile Plot&quot;</span>,</span>
<span id="cb192-19"><a href="repeated-measures-anova.html#cb192-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Raw Data&quot;</span>)</span></code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-137-1.png" width="75%" /></p>
</div>
<div id="does-weight-long-change-over-time" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Does weight long change over time?<a href="repeated-measures-anova.html#does-weight-long-change-over-time" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fit the model</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="repeated-measures-anova.html#cb193-1" aria-hidden="true" tabindex="-1"></a>fit_wl <span class="ot">&lt;-</span> WeightLoss_long <span class="sc">%&gt;%</span> </span>
<span id="cb193-2"><a href="repeated-measures-anova.html#cb193-2" aria-hidden="true" tabindex="-1"></a>  afex<span class="sc">::</span><span class="fu">aov_4</span>(wl <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (month<span class="sc">|</span>id),</span>
<span id="cb193-3"><a href="repeated-measures-anova.html#cb193-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> .)</span></code></pre></div>
<p>Brief output - uses the Greenhouse-Geisser correction for violations of sphericity (by default)</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="repeated-measures-anova.html#cb194-1" aria-hidden="true" tabindex="-1"></a>fit_wl</span></code></pre></div>
<pre><code>Anova Table (Type 3 tests)

Response: wl
  Effect          df  MSE         F  ges p.value
1  month 2.00, 65.94 1.08 80.31 *** .427   &lt;.001
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1

Sphericity correction method: GG </code></pre>
<p>Lots more output</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="repeated-measures-anova.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_wl)</span></code></pre></div>
<pre><code>
Univariate Type III Repeated-Measures ANOVA Assuming Sphericity

             Sum Sq num Df Error SS den Df F value    Pr(&gt;F)    
(Intercept) 1584.35      1  162.314     33 322.115 &lt; 2.2e-16 ***
month        173.88      2   71.451     66  80.308 &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1


Mauchly Tests for Sphericity

      Test statistic p-value
month        0.99908 0.98539


Greenhouse-Geisser and Huynh-Feldt Corrections
 for Departure from Sphericity

       GG eps Pr(&gt;F[GG])    
month 0.99908  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

        HF eps   Pr(&gt;F[HF])
month 1.063446 2.090759e-18</code></pre>
<p>To force no GG correction:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="repeated-measures-anova.html#cb198-1" aria-hidden="true" tabindex="-1"></a>fit_wl_noGG <span class="ot">&lt;-</span> WeightLoss_long <span class="sc">%&gt;%</span> </span>
<span id="cb198-2"><a href="repeated-measures-anova.html#cb198-2" aria-hidden="true" tabindex="-1"></a>  afex<span class="sc">::</span><span class="fu">aov_4</span>(wl <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (month<span class="sc">|</span>id),</span>
<span id="cb198-3"><a href="repeated-measures-anova.html#cb198-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> .,</span>
<span id="cb198-4"><a href="repeated-measures-anova.html#cb198-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">correction =</span> <span class="st">&quot;none&quot;</span>)) </span>
<span id="cb198-5"><a href="repeated-measures-anova.html#cb198-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-6"><a href="repeated-measures-anova.html#cb198-6" aria-hidden="true" tabindex="-1"></a>fit_wl_noGG</span></code></pre></div>
<pre><code>Anova Table (Type 3 tests)

Response: wl
  Effect    df  MSE         F  ges p.value
1  month 2, 66 1.08 80.31 *** .427   &lt;.001
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1</code></pre>
<p>To request BOTH effect sizes: partial eta squared and generalized eta squared</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="repeated-measures-anova.html#cb200-1" aria-hidden="true" tabindex="-1"></a>fit_wl_2es <span class="ot">&lt;-</span> WeightLoss_long <span class="sc">%&gt;%</span> </span>
<span id="cb200-2"><a href="repeated-measures-anova.html#cb200-2" aria-hidden="true" tabindex="-1"></a>  afex<span class="sc">::</span><span class="fu">aov_4</span>(wl <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (month<span class="sc">|</span>id),</span>
<span id="cb200-3"><a href="repeated-measures-anova.html#cb200-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> .,</span>
<span id="cb200-4"><a href="repeated-measures-anova.html#cb200-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">es =</span> <span class="fu">c</span>(<span class="st">&quot;ges&quot;</span>, <span class="st">&quot;pes&quot;</span>))) </span>
<span id="cb200-5"><a href="repeated-measures-anova.html#cb200-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-6"><a href="repeated-measures-anova.html#cb200-6" aria-hidden="true" tabindex="-1"></a>fit_wl_2es</span></code></pre></div>
<pre><code>Anova Table (Type 3 tests)

Response: wl
  Effect          df  MSE         F  ges  pes p.value
1  month 2.00, 65.94 1.08 80.31 *** .427 .709   &lt;.001
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1

Sphericity correction method: GG </code></pre>
<p>To force no GG correction AND request BOTH effect sizes</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="repeated-measures-anova.html#cb202-1" aria-hidden="true" tabindex="-1"></a>fit_wl_noGG <span class="ot">&lt;-</span> WeightLoss_long <span class="sc">%&gt;%</span> </span>
<span id="cb202-2"><a href="repeated-measures-anova.html#cb202-2" aria-hidden="true" tabindex="-1"></a>  afex<span class="sc">::</span><span class="fu">aov_4</span>(wl <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (month<span class="sc">|</span>id),</span>
<span id="cb202-3"><a href="repeated-measures-anova.html#cb202-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> .,</span>
<span id="cb202-4"><a href="repeated-measures-anova.html#cb202-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">anova_table =</span> <span class="fu">list</span>(<span class="at">correction =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb202-5"><a href="repeated-measures-anova.html#cb202-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">es =</span> <span class="fu">c</span>(<span class="st">&quot;ges&quot;</span>, <span class="st">&quot;pes&quot;</span>))) </span>
<span id="cb202-6"><a href="repeated-measures-anova.html#cb202-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-7"><a href="repeated-measures-anova.html#cb202-7" aria-hidden="true" tabindex="-1"></a>fit_wl_noGG</span></code></pre></div>
<pre><code>Anova Table (Type 3 tests)

Response: wl
  Effect    df  MSE         F  ges  pes p.value
1  month 2, 66 1.08 80.31 *** .427 .709   &lt;.001
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Estimated marginal means</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="repeated-measures-anova.html#cb204-1" aria-hidden="true" tabindex="-1"></a>fit_wl <span class="sc">%&gt;%</span> </span>
<span id="cb204-2"><a href="repeated-measures-anova.html#cb204-2" aria-hidden="true" tabindex="-1"></a>  emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="sc">~</span> month)</span></code></pre></div>
<pre><code> month emmean    SE df lower.CL upper.CL
 X1      5.29 0.288 33     4.71     5.88
 X2      4.35 0.295 33     3.75     4.95
 X3      2.18 0.196 33     1.78     2.57

Confidence level used: 0.95 </code></pre>
<p>pairwise post hoc</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="repeated-measures-anova.html#cb206-1" aria-hidden="true" tabindex="-1"></a>fit_wl <span class="sc">%&gt;%</span> </span>
<span id="cb206-2"><a href="repeated-measures-anova.html#cb206-2" aria-hidden="true" tabindex="-1"></a>  emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="sc">~</span> month) <span class="sc">%&gt;%</span> </span>
<span id="cb206-3"><a href="repeated-measures-anova.html#cb206-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>(<span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<pre><code> contrast estimate    SE df t.ratio p.value
 X1 - X2     0.941 0.250 33   3.771  0.0006
 X1 - X3     3.118 0.256 33  12.178  &lt;.0001
 X2 - X3     2.176 0.251 33   8.656  &lt;.0001</code></pre>
<p>means plot</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="repeated-measures-anova.html#cb208-1" aria-hidden="true" tabindex="-1"></a>fit_wl <span class="sc">%&gt;%</span> </span>
<span id="cb208-2"><a href="repeated-measures-anova.html#cb208-2" aria-hidden="true" tabindex="-1"></a>  emmeans<span class="sc">::</span><span class="fu">emmip</span>( <span class="sc">~</span> month)</span></code></pre></div>
<p><img src="eBook_install_files/figure-html/unnamed-chunk-146-1.png" width="75%" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="poison-example-1-2-way-anova.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mixed-design-anova.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
