[
["index.html", "Encyclopedia of Quantitative Methods in R, vol. 3: Testing Mean Differences Welcome Blocked Notes Code and Output The Authors", " Encyclopedia of Quantitative Methods in R, vol. 3: Testing Mean Differences Sarah Schwartz &amp; Tyson Barrett Last updated: 2019-02-12 Welcome Backgroup and links to other volumes of this encyclopedia may be found at the Encyclopedia’s Home Website. Blocked Notes Thoughout all the eBooks in this encyclopedia, several small secitons will be blocked out in the following ways: These blocks denote an area UNDER CONSTRUCTION, so check back often. This massive undertaking started during the summer of 2018 and is far from complete. The outline of seven volumes is given above despite any one being complete. Feedback is welcome via either author’s email. These blocks denote something EXTREMELY IMPORTANT. Do NOT skip these notes as they will be used very sparingly. These blocks denote something to DOWNLOAD. This may include software installations, example datasets, or notebook code files. These blocks denote something INTERESTING. These point out information we found of interest or added value. These blocks denote LINKS to other websites. This may include instructional video clips, articles, or blog posts. We are all about NOT re-creating the wheel. If somebody else has described or illustrated a topic well, we celebrate it! Code and Output This is how \\(R\\) code is shown: 1 + 1 This is what the output of the \\(R\\) code above will look: ## [1] 2 The Authors Dr. Sarah Schwartz Dr. Tyson Barrett www.SarahSchwartzStats.com www.TysonBarrett.com Sarah.Schwartz@usu.edu Tyson.Barrett@usu.edu Statistical Consulting Studio Data Science and Discover Unit Why choose R ? Check it out: an article from Fall 2016… No more excuses: R is better than SPSS for psychology undergrads, and students agree FYI This entire encyclopedia is written in \\(R Markdown\\), using \\(R Studio\\) as the text editor and the bookdown package to turn a collection of markdown documents into a coherent whole. The book’s source code is hosted on GitHub. If you notice typos or other issues, feel free to email either of the authors. This work is licensed under the Attribution-NonCommercial-NoDerivatives 4.0 International License. "],
["t-test-for-the-mean-of-1-sample.html", "1 t TEST FOR THE MEAN OF 1 SAMPLE 1.1 Required Packages 1.2 Example Dataset - Cancer Experiment 1.3 1 Sample Mean vs. historic control 1.4 Change the Confidence Level 1.5 Restrict to a Subsample", " 1 t TEST FOR THE MEAN OF 1 SAMPLE 1.1 Required Packages library(tidyverse) # Loads several very helpful &#39;tidy&#39; packages library(haven) # Read in SPSS datasets 1.2 Example Dataset - Cancer Experiment Source of Data Mid-Michigan Medical Center, Midland, Michigan, 1999: A study of oral condition of cancer patients. Description of the Study The data set contains part of the data for a study of oral condition of cancer patients conducted at the Mid-Michigan Medical Center. The oral conditions of the patients were measured and recorded at the initial stage, at the end of the second week, at the end of the fourth week, and at the end of the sixth week. The variables age, initial weight and initial cancer stage of the patients were recorded. Patients were divided into two groups at random: One group received a placebo and the other group received aloe juice treatment. Sample size \\(n = 25\\) patients with neck cancer. The treatment is Aloe Juice. Variables Included ID patient identification number trt treatment group 0 placebo 1 aloe juice age patient’s age, in years weightin patient’s weight (pounds) at the initial stage stage initial cancer stage coded 1 through 4 totalcin oral condition at the initial stage totalcw2 oral condition at the end of week 2 totalcw4 oral condition at the end of week 4 totalcw6 oral condition at the end of week 6 head(cancer_raw) # A tibble: 6 x 9 ID TRT AGE WEIGHIN STAGE TOTALCIN TOTALCW2 TOTALCW4 TOTALCW6 &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; 1 1 0 52 124 2 6 6 6 7 2 5 0 77 160 1 9 6 10 9 3 6 0 60 136. 4 7 9 17 19 4 9 0 61 180. 1 6 7 9 3 5 11 0 59 176. 2 6 7 16 13 6 15 0 69 168. 1 6 6 6 11 1.3 1 Sample Mean vs. historic control example: Do the patients weigh more than 165 pounds at intake, on average? cancer_clean %&gt;% dplyr::pull(weighin) %&gt;% t.test(mu = 165) One Sample t-test data: . t = 2.0765, df = 24, p-value = 0.04872 alternative hypothesis: true mean is not equal to 165 95 percent confidence interval: 165.0807 191.4793 sample estimates: mean of x 178.28 1.4 Change the Confidence Level Find a 99% confience level for the population mean weight. cancer_clean %&gt;% dplyr::pull(weighin) %&gt;% t.test(mu = 165, conf.level = 0.99) One Sample t-test data: . t = 2.0765, df = 24, p-value = 0.04872 alternative hypothesis: true mean is not equal to 165 99 percent confidence interval: 160.3927 196.1673 sample estimates: mean of x 178.28 1.5 Restrict to a Subsample Do the patients with .dcoral[stage 3 &amp; 4] cancer weigh more than 165 pounds at intake, on average? cancer_clean %&gt;% dplyr::filter(stage %in% c(&quot;3&quot;, &quot;4&quot;)) %&gt;% dplyr::pull(weighin) %&gt;% t.test(mu = 165) One Sample t-test data: . t = 0.82627, df = 5, p-value = 0.4463 alternative hypothesis: true mean is not equal to 165 95 percent confidence interval: 137.0283 219.4717 sample estimates: mean of x 178.25 "],
["t-test-for-the-difference-in-2-means-independent-samples.html", "2 t TEST FOR THE DIFFERENCE IN 2 MEANS, INDEPENDENT SAMPLES 2.1 Required Packages 2.2 Example Dataset - Cancer Experiment 2.3 Eyeball method 2.4 Formal Statistical Test", " 2 t TEST FOR THE DIFFERENCE IN 2 MEANS, INDEPENDENT SAMPLES 2.1 Required Packages library(tidyverse) # Loads several very helpful &#39;tidy&#39; packages library(haven) # Read in SPSS datasets library(car) # Companion for Applied Regression (and ANOVA) 2.2 Example Dataset - Cancer Experiment The Cancer dataset was introduced in “t TEST FOR THE MEAN OF 1 SAMPLE”. cancer_raw &lt;- haven::read_spss(&quot;https://raw.githubusercontent.com/CEHS-research/eBook_ANOVA/master/data/Cancer.sav&quot;) tibble::glimpse(cancer_raw) Observations: 25 Variables: 9 $ ID &lt;dbl&gt; 1, 5, 6, 9, 11, 15, 21, 26, 31, 35, 39, 41, 45, 2, 12... $ TRT &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1,... $ AGE &lt;dbl&gt; 52, 77, 60, 61, 59, 69, 67, 56, 61, 51, 46, 65, 67, 4... $ WEIGHIN &lt;dbl&gt; 124.0, 160.0, 136.5, 179.6, 175.8, 167.6, 186.0, 158.... $ STAGE &lt;dbl&gt; 2, 1, 4, 1, 2, 1, 1, 3, 1, 1, 4, 1, 1, 2, 4, 1, 2, 1,... $ TOTALCIN &lt;dbl&gt; 6, 9, 7, 6, 6, 6, 6, 6, 6, 6, 7, 6, 8, 7, 6, 4, 6, 6,... $ TOTALCW2 &lt;dbl&gt; 6, 6, 9, 7, 7, 6, 11, 11, 9, 4, 8, 6, 8, 16, 10, 6, 1... $ TOTALCW4 &lt;dbl&gt; 6, 10, 17, 9, 16, 6, 11, 15, 6, 8, 11, 9, 9, 9, 11, 8... $ TOTALCW6 &lt;dbl&gt; 7, 9, 19, 3, 13, 11, 10, 15, 8, 7, 11, 6, 10, 10, 9, ... cancer_clean &lt;- cancer_raw %&gt;% dplyr::rename_all(tolower) %&gt;% dplyr::mutate(id = factor(id)) %&gt;% dplyr::mutate(trt = factor(trt, labels = c(&quot;Placebo&quot;, &quot;Aloe Juice&quot;))) %&gt;% dplyr::mutate(stage = factor(stage)) tibble::glimpse(cancer_clean) Observations: 25 Variables: 9 $ id &lt;fct&gt; 1, 5, 6, 9, 11, 15, 21, 26, 31, 35, 39, 41, 45, 2, 12... $ trt &lt;fct&gt; Placebo, Placebo, Placebo, Placebo, Placebo, Placebo,... $ age &lt;dbl&gt; 52, 77, 60, 61, 59, 69, 67, 56, 61, 51, 46, 65, 67, 4... $ weighin &lt;dbl&gt; 124.0, 160.0, 136.5, 179.6, 175.8, 167.6, 186.0, 158.... $ stage &lt;fct&gt; 2, 1, 4, 1, 2, 1, 1, 3, 1, 1, 4, 1, 1, 2, 4, 1, 2, 1,... $ totalcin &lt;dbl&gt; 6, 9, 7, 6, 6, 6, 6, 6, 6, 6, 7, 6, 8, 7, 6, 4, 6, 6,... $ totalcw2 &lt;dbl&gt; 6, 6, 9, 7, 7, 6, 11, 11, 9, 4, 8, 6, 8, 16, 10, 6, 1... $ totalcw4 &lt;dbl&gt; 6, 10, 17, 9, 16, 6, 11, 15, 6, 8, 11, 9, 9, 9, 11, 8... $ totalcw6 &lt;dbl&gt; 7, 9, 19, 3, 13, 11, 10, 15, 8, 7, 11, 6, 10, 10, 9, ... psych::headTail(cancer_clean) id trt age weighin stage totalcin totalcw2 totalcw4 totalcw6 1 1 Placebo 52 124 2 6 6 6 7 2 5 Placebo 77 160 1 9 6 10 9 3 6 Placebo 60 136.5 4 7 9 17 19 4 9 Placebo 61 179.6 1 6 7 9 3 5 &lt;NA&gt; &lt;NA&gt; ... ... &lt;NA&gt; ... ... ... ... 6 42 Aloe Juice 73 181.5 0 8 11 16 &lt;NA&gt; 7 44 Aloe Juice 67 187 1 5 7 7 7 8 50 Aloe Juice 60 164 2 6 8 16 &lt;NA&gt; 9 58 Aloe Juice 54 172.8 4 7 8 10 8 2.3 Eyeball method Do the two groups, treatment and control, have different oral conditions at initial observation? Judge any difference in centers (means) within the context of the within group spread (stadard deviation/variance) 2.3.1 Means and SDs cancer_clean %&gt;% dplyr::group_by(trt) %&gt;% furniture::table1(totalcin, totalcw4, na.rm = FALSE) -------------------------------- trt Placebo Aloe Juice n = 14 n = 11 totalcin 6.6 (0.9) 6.5 (2.1) totalcw4 10.1 (3.6) 10.6 (3.5) -------------------------------- 2.3.2 Stacked Histograms 2.3.2.1 Baseline Oral Condition cancer_clean %&gt;% ggplot(aes(totalcin)) + geom_histogram(bins = 10) + facet_grid(trt ~ .) 2.3.2.2 Four Weeks Oral Condition cancer_clean %&gt;% ggplot(aes(totalcw4)) + geom_histogram(bins = 10) + facet_grid(trt ~ .) 2.3.3 Side-by-Side Boxplots 2.3.3.1 Baseline Oral Condition cancer_clean %&gt;% ggplot(aes(x = trt, y = totalcin)) + geom_boxplot() 2.3.3.2 Four Weeks Oral Condition cancer_clean %&gt;% ggplot(aes(x = trt, y = totalcw4)) + geom_boxplot() 2.4 Formal Statistical Test 2.4.1 Assumption (1): Two Samples are Indepdented, Simple-Random Samples Can not check statistically. Can only ensure through good sampling. 2.4.2 Assumption (2): Two Populations are Normaly Distributed The first assumption to check is if the continuous variable of interest (dependent variable, DV, or outcome) is NORMALLY approximately distributed within each sample. This is best done visually with a histogram (above) or a quantile-quantile plot (below). On the QQ plot, a normally distributed sample will have all the data points along a straight diagnoal line. 2.4.2.1 Baseline Oral Condition cancer_clean %&gt;% ggplot(aes(sample = totalcin)) + geom_qq() + stat_qq_line() + facet_grid(. ~ trt) 2.4.2.2 Four Weeks Oral Condition cancer_clean %&gt;% ggplot(aes(sample = totalcw4)) + geom_qq() + stat_qq_line() + facet_grid(. ~ trt) 2.4.3 Assumption (2): Two Populations exhibit Homogeneity of Variance (HOV) Before performing the \\(t\\) test, check to see if the assumption of homogeneity of variance is met using Levene’s Test. For a independent samples t-test for means, the groups need to have the same amount of spread (SD) in the measure of interest. Use the car:leveneTest() function tests the HOV assumtion. Inside the funtion you need to specify at least three options (sepearated by commas): the formula: continuous_var ~ grouping_var (replace with your variable names) the dataset: data = . to pipe it from above the center: center = “mean” since we are comparing means 2.4.3.1 Baseline Oral Condition Do the participants in the treatment and control groups have the same spread in oral condition at BASELINE? cancer_clean %&gt;% car::leveneTest(totalcin ~ trt, # formula: continuous_var ~ grouping_var data = ., # pipe in the dataset center = &quot;mean&quot;) # The default is &quot;median&quot; Levene&#39;s Test for Homogeneity of Variance (center = &quot;mean&quot;) Df F value Pr(&gt;F) group 1 2.2103 0.1507 23 No violations of homogeneity were detected, \\(F(1, 23) = 2.210, p = .151\\). 2.4.3.2 Four Weeks Oral Condition Do the participants in the treatment and control groups have the same spread in oral condition at the FOURTH WEEK? cancer_clean %&gt;% car::leveneTest(totalcw4 ~ trt, # formula: continuous_var ~ grouping_var data = ., # pipe in the dataset center = &quot;mean&quot;) # The default is &quot;median&quot; Levene&#39;s Test for Homogeneity of Variance (center = &quot;mean&quot;) Df F value Pr(&gt;F) group 1 0 0.995 23 No violations of homogeneity were detected, \\(F(1, 23) = 0, p = .995\\). 2.4.4 t-Test for Difference in Means Use the same t.test() funtion we have used for a single sample, but speficy a few more options. Inside the funtion you need to specify at least three options (sepearated by commas): the formula: continuous_var ~ grouping_var (replace with your variable names) the dataset: data = . to pipe it from above You MAY need/want to specify some or all of the following options you may way to leave as the default or override: HOV assumed: var.equal = FALSE Default Seperate-Variance test using Welch’s df var.equal = TRUE Pooled-Variance test (if HOV is NOT violated) Number of tails: alternative = “two.sided” Default Allows for a 2-sided alternative alternative = “less” Only Allows \\(H_0: \\mu_1 - \\mu_2 &amp;lt; 0\\) alternative = “more Only Allows \\(H_0: \\mu_1 - \\mu_2 &amp;gt; 0\\) Independent vs. paired: paired = FALSE Default Conducts an INDEOENDENT groups t-Test paired = TRUE Conducts a PAIRED meausres t-Test Confidence level: conf.level = 0.95 Default Computes the 95% confidence inverval conf.level = 0.90 Changes to a 90% confidence interval 2.4.4.1 Baseline Oral Condition Do the participants in the treatment group have a different average oral condition at BASELINE, compared to the control group? # Minimal syntax cancer_clean %&gt;% t.test(totalcin ~ trt, # formula: continuous_var ~ grouping_var data = ., # pipe in the dataset var.equal = TRUE) # HOV was violated (option = TRUE) Two Sample t-test data: totalcin by trt t = 0.18566, df = 23, p-value = 0.8543 alternative hypothesis: true difference in means is not equal to 0 95 percent confidence interval: -1.185479 1.419245 sample estimates: mean in group Placebo mean in group Aloe Juice 6.571429 6.454545 No evidence of a differnece in mean oral condition at baseline, \\(t(23) = 0.186, p = .854\\). 2.4.4.2 Four Weeks Oral Condition Do the participants in the treatment group have a different average oral condition at the FOURTH WEEK, compared to the control group? # Fully specified function cancer_clean %&gt;% t.test(totalcw4 ~ trt, # formula: continuous_var ~ grouping_var data = ., # pipe in the dataset var.equal = TRUE, # default: HOV was violated (option = TRUE) alternative = &quot;two.sided&quot;, # default: 2 sided (options = &quot;less&quot;, &quot;greater&quot;) paired = FALSE, # default: independent (option = TRUE) conf.level = .95) # default: 95% (option = .9, .90, ect.) Two Sample t-test data: totalcw4 by trt t = -0.34598, df = 23, p-value = 0.7325 alternative hypothesis: true difference in means is not equal to 0 95 percent confidence interval: -3.444215 2.457202 sample estimates: mean in group Placebo mean in group Aloe Juice 10.14286 10.63636 No evidence of a differnece in mean oral condition at the fourth week, \\(t(23) = -0.350, p = .733\\). "],
["ex-obese.html", "3 Ex: Obese 3.1 Dataset Background 3.2 Data Wrangling &amp; Preparation 3.3 Exploratory Analysis of Raw Data 3.4 Inferncial Analysis with Modeling 3.5 Results &amp; Discussion", " 3 Ex: Obese 3.1 Dataset Background 1+1 ## [1] 2 3.2 Data Wrangling &amp; Preparation 3.2.1 Read in Raw Data 3.2.2 Format Variables 3.2.3 Create New VAriables 3.2.4 Restructure 3.3 Exploratory Analysis of Raw Data 3.3.1 Tabulate 3.3.1.1 Summary Statistics 3.3.2 Visualize 3.3.2.1 Univariate Distributions 3.3.2.2 Bivariate Distributions 3.4 Inferncial Analysis with Modeling 3.4.1 ANOVA 3.4.1.1 Tabulate 3.4.1.2 Visualize 3.4.2 Regression 3.4.2.1 Tabulate 3.4.2.2 Visualize 3.5 Results &amp; Discussion "],
["references.html", "References", " References "]
]
